use alloy_sol_types::SolType;
use alloy_ethers_typecast::transaction::{
    ReadContractParametersBuilder, ReadContractParametersBuilderError, ReadableClient,
    ReadableClientError,
};
use alloy_primitives::hex::{encode, FromHexError};
use alloy_sol_types::{sol, private::Address};
use rain_metaboard_subgraph::metaboard_client::MetaboardSubgraphClient;
use crate::meta::{KnownMagic, RainMetaDocumentV1Item};
use rain_metadata_bindings::IDescribedByMetaV1;
use thiserror::Error;

#[derive(Debug, Clone)]
pub struct AuthoringMetaV2Word {
    pub word: String,
    pub description: String,
}

#[derive(Debug, Clone)]
pub struct AuthoringMetaV2 {
    pub words: Vec<AuthoringMetaV2Word>,
}

sol!(
    struct AuthoringMetaV2Sol {
        // `word` is referenced directly in assembly so don't move the field. It MUST
        // be the first item.
        bytes32 word;
        string description;
    }
);

type AuthoringMetasV2Sol = sol! { AuthoringMetaV2Sol[] };

#[derive(Error, Debug)]
pub enum AuthoringMetaV2Error {
    #[error(transparent)]
    FromHexError(#[from] FromHexError),
    #[error(transparent)]
    UrlParseError(#[from] url::ParseError),
    #[error(transparent)]
    ReadableClientError(#[from] ReadableClientError),
    #[error(transparent)]
    ReadContractParametersError(#[from] ReadContractParametersBuilderError),
    #[error(transparent)]
    MetaboardSubgraphError(
        #[from] rain_metaboard_subgraph::metaboard_client::MetaboardSubgraphClientError,
    ),
    #[error("Meta bytes do not start with RainMetaDocumentV1 Magic")]
    MetaMagicNumberMismatch,
    #[error(transparent)]
    AbiDecodeError(#[from] alloy_sol_types::Error),
    #[error(transparent)]
    Utf8Error(#[from] std::string::FromUtf8Error),
    #[error(transparent)]
    MetaError(#[from] crate::error::Error),
}

/// Implementation of the AuthoringMetaV2 struct.
impl AuthoringMetaV2 {
    /// Decodes the ABI encoded bytes into an AuthoringMetaV2 struct.
    ///
    /// # Arguments
    ///
    /// * `bytes` - The bytes to decode.
    ///
    /// # Returns
    ///
    /// An AuthoringMetaV2 struct if successful, or an AuthoringMetaV2Error if an error occurs.
    pub fn abi_decode(bytes: &[u8]) -> Result<Self, AuthoringMetaV2Error> {
        println!("bytes: {:?}", encode(bytes));
        let decoded = AuthoringMetasV2Sol::abi_decode(bytes, true)?;

        let mut words = Vec::new();

        for item in decoded.iter() {
            words.push(AuthoringMetaV2Word {
                word: String::from_utf8(item.word.as_slice().into())?,
                description: item.description.clone(),
            });
        }

        Ok(AuthoringMetaV2 { words })
    }

    /// Fetches the authoring meta for a contract that implements IDescribedByMetaV1
    /// from the metaboard.
    ///
    /// # Arguments
    ///
    /// * `contract_address` - The address of the contract.
    ///
    /// # Returns
    ///
    /// An empty result if successful, or a AuthoringMetaV2Error if an error occurs.
    pub async fn fetch_for_contract(
        contract_address: Address,
        rpc_url: String,
        metaboard_url: String,
    ) -> Result<Self, AuthoringMetaV2Error> {
        // get the metahash
        let client = ReadableClient::new_from_url(rpc_url.clone())?;
        let parameters = ReadContractParametersBuilder::default()
            .address(contract_address)
            .call(IDescribedByMetaV1::describedByMetaV1Call {})
            .build()?;
        let metahash = client.read(parameters).await?._0;

        // query the metaboard for the metas
        let subgraph_client = MetaboardSubgraphClient::new(metaboard_url.parse()?);
        let metas = subgraph_client.get_metabytes_by_hash(&metahash).await?;

        RainMetaDocumentV1Item::cbor_decode(metas[0].as_slice())?[0]
            .clone()
            .try_into()
    }
}

impl TryFrom<RainMetaDocumentV1Item> for AuthoringMetaV2 {
    type Error = AuthoringMetaV2Error;
    fn try_from(value: RainMetaDocumentV1Item) -> Result<Self, AuthoringMetaV2Error> {
        if value.magic != KnownMagic::AuthoringMetaV2 {
            return Err(AuthoringMetaV2Error::MetaMagicNumberMismatch);
        }
        let payload = value.unpack()?;
        AuthoringMetaV2::abi_decode(&payload)
    }
}

#[cfg(test)]
mod tests {
    use alloy_primitives::hex::decode;
    use serde_bytes::ByteBuf;

    use crate::meta::{ContentEncoding, ContentLanguage, ContentType};

    use super::*;

    #[tokio::test]
    async fn test_get_words_for_contract() {
        let metaboard_url = "https://api.goldsky.com/api/public/project_clv14x04y9kzi01saerx7bxpg/subgraphs/test-polygon/0.0.1/gn".to_string();
        let rpc_url = "https://rpc.ankr.com/polygon".to_string();
        let contract_address = "0xfca89cD12Ba1346b1ac570ed988AB43b812733fe"
            .parse()
            .unwrap();

        let res =
            AuthoringMetaV2::fetch_for_contract(contract_address, rpc_url, metaboard_url).await;

        match res {
            Ok(res) => println!("{:?}", res),
            Err(e) => println!("Error: {:?}", e),
        }
    }

    #[tokio::test]
    async fn test_try_from_valid() {
        let magic = KnownMagic::AuthoringMetaV2;
        let payload = decode::<String>("0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004d00000000000000000000000000000000000000000000000000000000000009a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000ae00000000000000000000000000000000000000000000000000000000000000be00000000000000000000000000000000000000000000000000000000000000cc00000000000000000000000000000000000000000000000000000000000000d600000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000ea00000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000108000000000000000000000000000000000000000000000000000000000000011400000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000136000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001520000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000016c000000000000000000000000000000000000000000000000000000000000017a000000000000000000000000000000000000000000000000000000000000018800000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001a800000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001ba00000000000000000000000000000000000000000000000000000000000001c600000000000000000000000000000000000000000000000000000000000001ce00000000000000000000000000000000000000000000000000000000000001da00000000000000000000000000000000000000000000000000000000000001f40000000000000000000000000000000000000000000000000000000000000204000000000000000000000000000000000000000000000000000000000000020e000000000000000000000000000000000000000000000000000000000000021a000000000000000000000000000000000000000000000000000000000000022600000000000000000000000000000000000000000000000000000000000002320000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000024a000000000000000000000000000000000000000000000000000000000000025400000000000000000000000000000000000000000000000000000000000002600000000000000000000000000000000000000000000000000000000000000276000000000000000000000000000000000000000000000000000000000000028a0000000000000000000000000000000000000000000000000000000000000294000000000000000000000000000000000000000000000000000000000000029e00000000000000000000000000000000000000000000000000000000000002ae00000000000000000000000000000000000000000000000000000000000002c200000000000000000000000000000000000000000000000000000000000002d600000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002ea00000000000000000000000000000000000000000000000000000000000002f8000000000000000000000000000000000000000000000000000000000000030a00000000000000000000000000000000000000000000000000000000000003180000000000000000000000000000000000000000000000000000000000000328000000000000000000000000000000000000000000000000000000000000033800000000000000000000000000000000000000000000000000000000000003480000000000000000000000000000000000000000000000000000000000000358000000000000000000000000000000000000000000000000000000000000036c000000000000000000000000000000000000000000000000000000000000037a000000000000000000000000000000000000000000000000000000000000039200000000000000000000000000000000000000000000000000000000000003ae00000000000000000000000000000000000000000000000000000000000003c200000000000000000000000000000000000000000000000000000000000003da00000000000000000000000000000000000000000000000000000000000003f6000000000000000000000000000000000000000000000000000000000000040c000000000000000000000000000000000000000000000000000000000000042400000000000000000000000000000000000000000000000000000000000004340000000000000000000000000000000000000000000000000000000000000442000000000000000000000000000000000000000000000000000000000000045200000000000000000000000000000000000000000000000000000000000004600000000000000000000000000000000000000000000000000000000000000470000000000000000000000000000000000000000000000000000000000000047c0000000000000000000000000000000000000000000000000000000000000488000000000000000000000000000000000000000000000000000000000000049400000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000004ae00000000000000000000000000000000000000000000000000000000000004be00000000000000000000000000000000000000000000000000000000000004da00000000000000000000000000000000000000000000000000000000000004e60000000000000000000000000000000000000000000000000000000000000504000000000000000000000000000000000000000000000000000000000000051400000000000000000000000000000000000000000000000000000000000005200737461636b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000028436f7069657320616e206578697374696e672076616c75652066726f6d2074686520737461636b2e000000000000000000000000000000000000000000000000636f6e7374616e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000027436f70696573206120636f6e7374616e742076616c7565206f6e746f2074686520737461636b2e0000000000000000000000000000000000000000000000000065787465726e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009b43616c6c7320616e2065787465726e616c20636f6e74726163742e20546865206f706572616e642069732074686520696e646578206f662074686520656e636f64656420646973706174636820696e2074686520636f6e7374616e74732061727261792e20546865206f7574707574732061726520696e6665727265642066726f6d20746865206e756d626572206f66204c4853206974656d732e0000000000636f6e746578740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000067436f7069657320612076616c75652066726f6d2074686520636f6e746578742e20546865206669727374206f706572616e642069732074686520636f6e7465787420636f6c756d6e20616e64207365636f6e642069732074686520636f6e7465787420726f772e00000000000000000000000000000000000000000000000000626974776973652d616e640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002b4269747769736520414e442074686520746f702074776f206974656d73206f6e2074686520737461636b2e000000000000000000000000000000000000000000626974776973652d6f72000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002a42697477697365204f522074686520746f702074776f206974656d73206f6e2074686520737461636b2e00000000000000000000000000000000000000000000626974776973652d636f756e742d6f6e6573000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000037436f756e747320746865206e756d626572206f662062696e61727920626974732073657420746f203120696e2074686520696e7075742e000000000000000000626974776973652d6465636f64650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008b4465636f64657320612076616c75652066726f6d206120323536206269742076616c756520746861742077617320656e636f646564207769746820626974776973652d656e636f64652e20546865206669727374206f706572616e64206973207468652073746172742062697420616e6420746865207365636f6e6420697320746865206c656e6774682e000000000000000000000000000000000000000000626974776973652d656e636f646500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000066456e636f64657320612076616c756520696e746f206120323536206269742076616c75652e20546865206669727374206f706572616e64206973207468652073746172742062697420616e6420746865207365636f6e6420697320746865206c656e6774682e0000000000000000000000000000000000000000000000000000626974776973652d73686966742d6c6566740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000455368696674732074686520696e707574206c65667420627920746865206e756d626572206f6620626974732073706563696669656420696e20746865206f706572616e642e000000000000000000000000000000000000000000000000000000626974776973652d73686966742d726967687400000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000465368696674732074686520696e70757420726967687420627920746865206e756d626572206f6620626974732073706563696669656420696e20746865206f706572616e642e000000000000000000000000000000000000000000000000000063616c6c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e743616c6c73206120736f7572636520627920696e64657820696e207468652073616d65205261696e2062797465636f64652e2054686520696e7075747320746f2063616c6c2061726520636f7069656420746f2074686520746f70206f66207468652063616c6c656420737461636b20616e6420746865206f7574707574732061726520636f70696564206261636b20746f207468652063616c6c696e6720737461636b206163636f7264696e6720746f20746865204c4853206974656d732e20546865206669727374206f706572616e642069732074686520736f7572636520696e6465782e0000000000000000000000000000000000000000000000000068617368000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000003e48617368657320616c6c20696e7075747320696e746f20612073696e676c6520333220627974652076616c7565207573696e67206b656363616b3235362e000065726332302d616c6c6f77616e63650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a1476574732074686520616c6c6f77616e6365206f6620616e20657263323020746f6b656e20666f7220616e206163636f756e742e2054686520666972737420696e7075742069732074686520746f6b656e20616464726573732c20746865207365636f6e6420697320746865206f776e657220616464726573732c20616e642074686520746869726420697320746865207370656e64657220616464726573732e0000000000000000000000000000000000000000000000000000000000000065726332302d62616c616e63652d6f66000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007e47657473207468652062616c616e6365206f6620616e20657263323020746f6b656e20666f7220616e206163636f756e742e2054686520666972737420696e7075742069732074686520746f6b656e206164647265737320616e6420746865207365636f6e6420697320746865206163636f756e7420616464726573732e000065726332302d746f74616c2d737570706c79000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000048476574732074686520746f74616c20737570706c79206f6620616e20657263323020746f6b656e2e2054686520696e7075742069732074686520746f6b656e20616464726573732e0000000000000000000000000000000000000000000000006572633732312d62616c616e63652d6f660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007f47657473207468652062616c616e6365206f6620616e2065726337323120746f6b656e20666f7220616e206163636f756e742e2054686520666972737420696e7075742069732074686520746f6b656e206164647265737320616e6420746865207365636f6e6420697320746865206163636f756e7420616464726573732e006572633732312d6f776e65722d6f660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000674765747320746865206f776e6572206f6620616e2065726337323120746f6b656e2e2054686520666972737420696e7075742069732074686520746f6b656e206164647265737320616e6420746865207365636f6e642069732074686520746f6b656e2069642e00000000000000000000000000000000000000000000000000657263353331332d6f776e657200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001064765747320746865206f776e6572206f6620616e206572633533313320636f6d70617469626c6520636f6e74726163742e204e6f746520746861742065726335333133207370656369666963616c6c7920444f4553204e4f5420646f20616e79206f6e636861696e20636f6d7061746962696c69747920636865636b732c20736f207468652065787072657373696f6e20617574686f7220697320726573706f6e7369626c6520666f7220656e737572696e672074686520636f6e747261637420697320636f6d70617469626c652e2054686520696e7075742069732074686520636f6e7472616374206164647265737320746f2067657420746865206f776e6572206f662e0000000000000000000000000000000000000000000000000000626c6f636b2d6e756d6265720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000195468652063757272656e7420626c6f636b206e756d6265722e00000000000000636861696e2d6964000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000155468652063757272656e7420636861696e2069642e00000000000000000000006d61782d696e742d76616c7565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000003b546865206d6178696d756d20706f737369626c65206e6f6e2d6e6567617469766520696e74656765722076616c75652e20325e323536202d20312e00000000006d61782d646563696d616c31382d76616c75650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000043546865206d6178696d756d20706f737369626c6520313820646563696d616c20666978656420706f696e742076616c75652e20726f7567686c7920312e31356537372e0000000000000000000000000000000000000000000000000000000000626c6f636b2d74696d657374616d7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001c5468652063757272656e7420626c6f636b2074696d657374616d702e00000000616e79000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000045546865206669727374206e6f6e2d7a65726f2076616c7565206f7574206f6620616c6c20696e707574732c206f72203020696620657665727920696e70757420697320302e000000000000000000000000000000000000000000000000000000636f6e646974696f6e73000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000014054726561747320696e7075747320617320706169727769736520636f6e646974696f6e2f76616c75652070616972732e20546865206669727374206e6f6e7a65726f20636f6e646974696f6e27732076616c756520697320757365642e204966206e6f20636f6e646974696f6e7320617265206e6f6e7a65726f2c207468652065787072657373696f6e20726576657274732e2050726f76696465206120636f6e7374616e74206e6f6e7a65726f2076616c756520746f20646566696e6520612066616c6c6261636b20636173652e20496620746865206e756d626572206f6620696e70757473206973206f64642c207468652066696e616c2076616c7565206973207573656420617320616e206572726f7220737472696e6720696e2074686520636173652074686174206e6f20636f6e646974696f6e73206d617463682e656e73757265000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000087526576657274732069662074686520666972737420696e70757420697320302e20546865207365636f6e6420696e707574206973206120737472696e6720746861742069732075736564206173207468652072657665727420726561736f6e2069662074686520666972737420696e70757420697320302e204861732030206f7574707574732e00000000000000000000000000000000000000000000000000657175616c2d746f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000273120696620616c6c20696e707574732061726520657175616c2c2030206f74686572776973652e00000000000000000000000000000000000000000000000000657665727900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041546865206c617374206e6f6e7a65726f2076616c7565206f7574206f6620616c6c20696e707574732c206f72203020696620616e7920696e70757420697320302e00000000000000000000000000000000000000000000000000000000000000677265617465722d7468616e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000043312069662074686520666972737420696e7075742069732067726561746572207468616e20746865207365636f6e6420696e7075742c2030206f74686572776973652e0000000000000000000000000000000000000000000000000000000000677265617465722d7468616e2d6f722d657175616c2d746f00000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004f312069662074686520666972737420696e7075742069732067726561746572207468616e206f7220657175616c20746f20746865207365636f6e6420696e7075742c2030206f74686572776973652e000000000000000000000000000000000069660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007549662074686520666972737420696e707574206973206e6f6e7a65726f2c20746865207365636f6e6420696e70757420697320757365642e204f74686572776973652c2074686520746869726420696e70757420697320757365642e2049662069732065616765726c79206576616c75617465642e000000000000000000000069732d7a65726f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000021312069662074686520696e70757420697320302c2030206f74686572776973652e000000000000000000000000000000000000000000000000000000000000006c6573732d7468616e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000040312069662074686520666972737420696e707574206973206c657373207468616e20746865207365636f6e6420696e7075742c2030206f74686572776973652e6c6573732d7468616e2d6f722d657175616c2d746f00000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004c312069662074686520666972737420696e707574206973206c657373207468616e206f7220657175616c20746f20746865207365636f6e6420696e7075742c2030206f74686572776973652e0000000000000000000000000000000000000000646563696d616c31382d6578706f6e656e7469616c2d67726f77746800000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e543616c63756c6174657320616e206578706f6e656e7469616c2067726f7774682063757276652061732060626173652831202b2072617465295e7460207768657265206062617365602069732074686520696e697469616c2076616c75652c20607261746560206973207468652072617465206f662067726f77746820616e642060746020697320756e697473206f662074696d652e20496e7075747320696e206f7264657220617265206062617365602c206072617465602c20616e642060746020726573706563746976656c7920617320646563696d616c2031382076616c7565732e000000000000000000000000000000000000000000000000000000646563696d616c31382d6c696e6561722d67726f777468000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e043616c63756c617465732061206c696e6561722067726f777468206375727665206173206062617365202b202872617465202a20742960207768657265206062617365602069732074686520696e697469616c2076616c75652c20607261746560206973207468652072617465206f662067726f77746820616e642060746020697320756e697473206f662074696d652e20496e7075747320696e206f7264657220617265206062617365602c206072617465602c20616e642060746020726573706563746976656c7920617320646563696d616c2031382076616c7565732e646563696d616c31382d6176670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000039313820646563696d616c20666978656420706f696e742061726974686d657469632061766572616765206f662074776f206e756d626572732e00000000000000646563696d616c31382d6365696c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002b313820646563696d616c20666978656420706f696e74206365696c696e67206f662061206e756d6265722e000000000000000000000000000000000000000000646563696d616c31382d6469760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000082446976696465732074686520666972737420696e70757420627920616c6c206f7468657220696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620616e792064697669736f72206973207a65726f2e000000000000000000000000000000000000000000000000000000000000646563696d616c31382d65787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c343616c63756c6174657320746865206e61747572616c206578706f6e656e7469616c20655e7820776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e0000000000000000000000000000000000000000000000000000000000646563696d616c31382d65787032000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c243616c63756c61746573207468652062696e617279206578706f6e656e7469616c20325e7820776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000000000000000000000000000000000000000646563696d616c31382d666c6f6f72000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000029313820646563696d616c20666978656420706f696e7420666c6f6f72206f662061206e756d6265722e0000000000000000000000000000000000000000000000646563696d616c31382d6672616300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000033313820646563696d616c20666978656420706f696e74206672616374696f6e616c2070617274206f662061206e756d6265722e00000000000000000000000000646563696d616c31382d676d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008043616c63756c61746573207468652067656f6d6574726963206d65616e206f6620616c6c20696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620616e7920696e707574206973207a65726f2e646563696d616c31382d68656164726f6f6d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a6313820646563696d616c20666978656420706f696e742068656164726f6f6d206f662061206e756d6265722e20492e652e207468652064697374616e636520746f20746865206e6578742077686f6c65206e756d626572202831653138202d2066726163287829292e205468652068656164726f6f6d20617420616e792077686f6c6520646563696d616c203138206e756d626572206973203165313820286e6f742030292e0000000000000000000000000000000000000000000000000000646563696d616c31382d696e76000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007f43616c63756c617465732074686520696e76657273652031202f2078206f662074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e00646563696d616c31382d6c6e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009143616c63756c6174657320746865206e61747572616c206c6f6761726974686d206c6e28782920776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e000000000000000000000000000000646563696d616c31382d6c6f67313000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009443616c63756c61746573207468652062617365203130206c6f6761726974686d206c6f67313028782920776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e000000000000000000000000646563696d616c31382d6c6f67320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009243616c63756c617465732074686520626173652032206c6f6761726974686d206c6f673228782920776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e0000000000000000000000000000646563696d616c31382d6d756c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a04d756c7469706c69657320616c6c20696e7075747320746f67657468657220617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206d756c7469706c69636174696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e646563696d616c31382d706f7765720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000cb5261697365732074686520666972737420696e707574206173206120666978656420706f696e7420313820646563696d616c2076616c756520746f2074686520706f776572206f6620746865207365636f6e6420696e707574206173206120666978656420706f696e7420313820646563696d616c2076616c75652e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000000000000000000000646563696d616c31382d706f7765722d696e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000685261697365732074686520666972737420696e707574206173206120666978656420706f696e7420313820646563696d616c2076616c756520746f2074686520706f776572206f6620746865207365636f6e6420696e70757420617320616e20696e74656765722e000000000000000000000000000000000000000000000000646563696d616c31382d7363616c652d31382d64796e616d6963000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001025363616c657320612076616c75652066726f6d20736f6d6520666978656420706f696e7420646563696d616c207363616c6520746f20313820646563696d616c20666978656420706f696e742e2054686520666972737420696e70757420697320746865207363616c6520746f207363616c652066726f6d20616e6420746865207365636f6e64206973207468652076616c756520746f207363616c652e205468652074776f206f7074696f6e616c206f706572616e647320636f6e74726f6c20726f756e64696e6720616e642073617475726174696f6e20726573706563746976656c79206173207065722060646563696d616c31382d7363616c652d3138602e000000000000000000000000000000000000000000000000000000000000646563696d616c31382d7363616c652d313800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000015d5363616c657320616e20696e7075742076616c75652066726f6d20736f6d6520666978656420706f696e7420646563696d616c207363616c6520746f20313820646563696d616c20666978656420706f696e742e20546865206669727374206f706572616e6420697320746865207363616c6520746f207363616c652066726f6d2e20546865207365636f6e6420286f7074696f6e616c29206f706572616e6420636f6e74726f6c7320726f756e64696e672077686572652030202864656661756c742920726f756e647320646f776e20616e64203120726f756e64732075702e2054686520746869726420286f7074696f6e616c29206f706572616e6420636f6e74726f6c732073617475726174696f6e2077686572652030202864656661756c7429206572726f7273206f6e206f766572666c6f7720616e64203120736174757261746573206174206d61782d646563696d616c2d76616c75652e000000696e742d746f2d646563696d616c313800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000ce5363616c657320616e20696e74656765722076616c756520746f20313820646563696d616c20666978656420706f696e742c20452e672e2031206265636f6d6573203165313820616e64203130206265636f6d657320316531392e204964656e746963616c20746f2060646563696d616c31382d7363616c652d313860207769746820616e20696e707574207363616c65206f6620302c206275742070657268617073206d6f7265206c656769626c652e20446f6573204e4f5420737570706f72742073617475726174696f6e2e000000000000000000000000000000000000646563696d616c31382d7363616c652d6e2d64796e616d696300000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001065363616c657320616e20696e7075742076616c75652066726f6d20313820646563696d616c20666978656420706f696e7420746f20736f6d65206f7468657220666978656420706f696e74207363616c65204e2e2054686520666972737420696e70757420697320746865207363616c6520746f207363616c6520746f20616e6420746865207365636f6e64206973207468652076616c756520746f207363616c652e205468652074776f206f7074696f6e616c206f706572616e6420636f6e74726f6c7320726f756e64696e6720616e642073617475726174696f6e20726573706563746976656c79206173207065722060646563696d616c31382d7363616c652d6e602e0000000000000000000000000000000000000000000000000000646563696d616c31382d7363616c652d6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000015b5363616c657320616e20696e7075742076616c75652066726f6d20313820646563696d616c20666978656420706f696e7420746f20736f6d65206f7468657220666978656420706f696e74207363616c65204e2e20546865206669727374206f706572616e6420697320746865207363616c6520746f207363616c6520746f2e20546865207365636f6e6420286f7074696f6e616c29206f706572616e6420636f6e74726f6c7320726f756e64696e672077686572652030202864656661756c742920726f756e647320646f776e20616e64203120726f756e64732075702e2054686520746869726420286f7074696f6e616c29206f706572616e6420636f6e74726f6c732073617475726174696f6e2077686572652030202864656661756c7429206572726f7273206f6e206f766572666c6f7720616e64203120736174757261746573206174206d61782d646563696d616c2d76616c75652e0000000000646563696d616c31382d746f2d696e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000f75363616c6573206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e652720697320316531382920746f2061206e6f6e2d6e6567617469766520696e74656765722e20416c7761797320666c6f6f72732f726f756e647320646f776e20616e79206672616374696f6e616c207061727420746f20746865206e6561726573742077686f6c6520696e74656765722e204964656e746963616c20746f2060646563696d616c31382d7363616c652d6e60207769746820616e20696e707574207363616c65206f6620302c206275742070657268617073206d6f7265206c656769626c652e000000000000000000646563696d616c31382d736e61702d746f2d756e69740000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000114526f756e6473206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e652720697320316531382920746f20746865206e6561726573742077686f6c65206e756d6265722069662069742069732077697468696e20746865207468726573686f6c642064697374616e63652066726f6d20746861742077686f6c65206e756d6265722e2054686520666972737420696e70757420697320746865207468726573686f6c6420617320616e20313820646563696d616c20666978656420706f696e74206e756d62657220616e6420746865207365636f6e64206973207468652076616c756520746f20736e617020746f20746865206e65617265737420756e69742e000000000000000000000000646563696d616c31382d737172740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008143616c63756c61746573207468652073717561726520726f6f74206f662074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973206e656761746976652e00000000000000000000000000000000000000000000000000000000000000696e742d61646400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000764164647320616c6c20696e7075747320746f676574686572206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620746865206164646974696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e00000000000000000000646563696d616c31382d61646400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000944164647320616c6c20696e7075747320746f67657468657220617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206164646974696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000696e742d6469760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000064446976696465732074686520666972737420696e70757420627920616c6c206f7468657220696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620616e792064697669736f72206973207a65726f2e00000000000000000000000000000000000000000000000000000000696e742d65787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a05261697365732074686520666972737420696e70757420746f2074686520706f776572206f6620616c6c206f7468657220696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e696e742d6d6178000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004146696e647320746865206d6178696d756d2076616c75652066726f6d20616c6c20696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e00000000000000000000000000000000000000000000000000000000000000646563696d616c31382d6d6178000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005f46696e647320746865206d6178696d756d2076616c75652066726f6d20616c6c20696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e00696e742d6d696e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004146696e647320746865206d696e696d756d2076616c75652066726f6d20616c6c20696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e00000000000000000000000000000000000000000000000000000000000000646563696d616c31382d6d696e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005f46696e647320746865206d696e696d756d2076616c75652066726f6d20616c6c20696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e00696e742d6d6f6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000644d6f64756c6f732074686520666972737420696e70757420627920616c6c206f7468657220696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620616e792064697669736f72206973207a65726f2e00000000000000000000000000000000000000000000000000000000696e742d6d756c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000824d756c7469706c69657320616c6c20696e7075747320746f676574686572206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620746865206d756c7469706c69636174696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000000000000000000000000000000000000000696e742d737562000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000015b53756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e707574206173206e6f6e2d6e6567617469766520696e7465676572732e20546865206f7074696f6e616c206f706572616e6420636f6e74726f6c732077686574686572207375627472616374696f6e2077696c6c20736174757261746520617420302e205468652064656661756c74206265686176696f75722c20616e6420776861742077696c6c2068617070656e20696620746865206f706572616e6420697320302c20697320746861742074686520776f72642077696c6c2072657665727420696620746865207375627472616374696f6e20776f756c6420726573756c7420696e2061206e656761746976652076616c75652e20496620746865206f706572616e6420697320312c2074686520776f72642077696c6c20736174757261746520617420302028652e672e20312d323d30292e0000000000696e742d73617475726174696e672d73756200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000006053756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e707574206173206e6f6e2d6e6567617469766520696e7465676572732e2053617475726174657320617420302028652e672e20312d323d30292e646563696d616c31382d737562000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000017f53756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e70757420617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e20546865206f7074696f6e616c206f706572616e6420636f6e74726f6c732077686574686572207375627472616374696f6e2077696c6c20736174757261746520617420302e205468652064656661756c74206265686176696f75722c20616e6420776861742077696c6c2068617070656e20696620746865206f706572616e6420697320302c20697320746861742074686520776f72642077696c6c2072657665727420696620746865207375627472616374696f6e20776f756c6420726573756c7420696e2061206e656761746976652076616c75652e20496620746865206f706572616e6420697320312c2074686520776f72642077696c6c20736174757261746520617420302028652e672e20316531382d326531383d30292e00646563696d616c31382d73617475726174696e672d73756200000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008453756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e70757420617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e2053617475726174657320617420302028652e672e20316531382d326531383d30292e000000000000000000000000000000000000000000000000000000006765740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000424765747320612076616c75652066726f6d2073746f726167652e20546865206669727374206f706572616e6420697320746865206b657920746f206c6f6f6b75702e0000000000000000000000000000000000000000000000000000000000007365740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000685365747320612076616c756520696e2073746f726167652e20546865206669727374206f706572616e6420697320746865206b657920746f2073657420616e6420746865207365636f6e64206f706572616e64206973207468652076616c756520746f207365742e000000000000000000000000000000000000000000000000".into()).unwrap();
        let item = RainMetaDocumentV1Item {
            magic,
            payload: ByteBuf::from(payload),
            content_encoding: ContentEncoding::None,
            content_language: ContentLanguage::None,
            content_type: ContentType::None,
        };

        let result = AuthoringMetaV2::try_from(item);

        assert!(result.is_ok());
    }

    #[tokio::test]
    async fn test_try_from_invalid_magic() {
        let magic = KnownMagic::AuthoringMetaV1;
        let payload = decode::<String>("0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000004d00000000000000000000000000000000000000000000000000000000000009a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000ae00000000000000000000000000000000000000000000000000000000000000be00000000000000000000000000000000000000000000000000000000000000cc00000000000000000000000000000000000000000000000000000000000000d600000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000ea00000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000108000000000000000000000000000000000000000000000000000000000000011400000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000136000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001520000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000016c000000000000000000000000000000000000000000000000000000000000017a000000000000000000000000000000000000000000000000000000000000018800000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001a800000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001ba00000000000000000000000000000000000000000000000000000000000001c600000000000000000000000000000000000000000000000000000000000001ce00000000000000000000000000000000000000000000000000000000000001da00000000000000000000000000000000000000000000000000000000000001f40000000000000000000000000000000000000000000000000000000000000204000000000000000000000000000000000000000000000000000000000000020e000000000000000000000000000000000000000000000000000000000000021a000000000000000000000000000000000000000000000000000000000000022600000000000000000000000000000000000000000000000000000000000002320000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000024a000000000000000000000000000000000000000000000000000000000000025400000000000000000000000000000000000000000000000000000000000002600000000000000000000000000000000000000000000000000000000000000276000000000000000000000000000000000000000000000000000000000000028a0000000000000000000000000000000000000000000000000000000000000294000000000000000000000000000000000000000000000000000000000000029e00000000000000000000000000000000000000000000000000000000000002ae00000000000000000000000000000000000000000000000000000000000002c200000000000000000000000000000000000000000000000000000000000002d600000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002ea00000000000000000000000000000000000000000000000000000000000002f8000000000000000000000000000000000000000000000000000000000000030a00000000000000000000000000000000000000000000000000000000000003180000000000000000000000000000000000000000000000000000000000000328000000000000000000000000000000000000000000000000000000000000033800000000000000000000000000000000000000000000000000000000000003480000000000000000000000000000000000000000000000000000000000000358000000000000000000000000000000000000000000000000000000000000036c000000000000000000000000000000000000000000000000000000000000037a000000000000000000000000000000000000000000000000000000000000039200000000000000000000000000000000000000000000000000000000000003ae00000000000000000000000000000000000000000000000000000000000003c200000000000000000000000000000000000000000000000000000000000003da00000000000000000000000000000000000000000000000000000000000003f6000000000000000000000000000000000000000000000000000000000000040c000000000000000000000000000000000000000000000000000000000000042400000000000000000000000000000000000000000000000000000000000004340000000000000000000000000000000000000000000000000000000000000442000000000000000000000000000000000000000000000000000000000000045200000000000000000000000000000000000000000000000000000000000004600000000000000000000000000000000000000000000000000000000000000470000000000000000000000000000000000000000000000000000000000000047c0000000000000000000000000000000000000000000000000000000000000488000000000000000000000000000000000000000000000000000000000000049400000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000004ae00000000000000000000000000000000000000000000000000000000000004be00000000000000000000000000000000000000000000000000000000000004da00000000000000000000000000000000000000000000000000000000000004e60000000000000000000000000000000000000000000000000000000000000504000000000000000000000000000000000000000000000000000000000000051400000000000000000000000000000000000000000000000000000000000005200737461636b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000028436f7069657320616e206578697374696e672076616c75652066726f6d2074686520737461636b2e000000000000000000000000000000000000000000000000636f6e7374616e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000027436f70696573206120636f6e7374616e742076616c7565206f6e746f2074686520737461636b2e0000000000000000000000000000000000000000000000000065787465726e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009b43616c6c7320616e2065787465726e616c20636f6e74726163742e20546865206f706572616e642069732074686520696e646578206f662074686520656e636f64656420646973706174636820696e2074686520636f6e7374616e74732061727261792e20546865206f7574707574732061726520696e6665727265642066726f6d20746865206e756d626572206f66204c4853206974656d732e0000000000636f6e746578740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000067436f7069657320612076616c75652066726f6d2074686520636f6e746578742e20546865206669727374206f706572616e642069732074686520636f6e7465787420636f6c756d6e20616e64207365636f6e642069732074686520636f6e7465787420726f772e00000000000000000000000000000000000000000000000000626974776973652d616e640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002b4269747769736520414e442074686520746f702074776f206974656d73206f6e2074686520737461636b2e000000000000000000000000000000000000000000626974776973652d6f72000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002a42697477697365204f522074686520746f702074776f206974656d73206f6e2074686520737461636b2e00000000000000000000000000000000000000000000626974776973652d636f756e742d6f6e6573000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000037436f756e747320746865206e756d626572206f662062696e61727920626974732073657420746f203120696e2074686520696e7075742e000000000000000000626974776973652d6465636f64650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008b4465636f64657320612076616c75652066726f6d206120323536206269742076616c756520746861742077617320656e636f646564207769746820626974776973652d656e636f64652e20546865206669727374206f706572616e64206973207468652073746172742062697420616e6420746865207365636f6e6420697320746865206c656e6774682e000000000000000000000000000000000000000000626974776973652d656e636f646500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000066456e636f64657320612076616c756520696e746f206120323536206269742076616c75652e20546865206669727374206f706572616e64206973207468652073746172742062697420616e6420746865207365636f6e6420697320746865206c656e6774682e0000000000000000000000000000000000000000000000000000626974776973652d73686966742d6c6566740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000455368696674732074686520696e707574206c65667420627920746865206e756d626572206f6620626974732073706563696669656420696e20746865206f706572616e642e000000000000000000000000000000000000000000000000000000626974776973652d73686966742d726967687400000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000465368696674732074686520696e70757420726967687420627920746865206e756d626572206f6620626974732073706563696669656420696e20746865206f706572616e642e000000000000000000000000000000000000000000000000000063616c6c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e743616c6c73206120736f7572636520627920696e64657820696e207468652073616d65205261696e2062797465636f64652e2054686520696e7075747320746f2063616c6c2061726520636f7069656420746f2074686520746f70206f66207468652063616c6c656420737461636b20616e6420746865206f7574707574732061726520636f70696564206261636b20746f207468652063616c6c696e6720737461636b206163636f7264696e6720746f20746865204c4853206974656d732e20546865206669727374206f706572616e642069732074686520736f7572636520696e6465782e0000000000000000000000000000000000000000000000000068617368000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000003e48617368657320616c6c20696e7075747320696e746f20612073696e676c6520333220627974652076616c7565207573696e67206b656363616b3235362e000065726332302d616c6c6f77616e63650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a1476574732074686520616c6c6f77616e6365206f6620616e20657263323020746f6b656e20666f7220616e206163636f756e742e2054686520666972737420696e7075742069732074686520746f6b656e20616464726573732c20746865207365636f6e6420697320746865206f776e657220616464726573732c20616e642074686520746869726420697320746865207370656e64657220616464726573732e0000000000000000000000000000000000000000000000000000000000000065726332302d62616c616e63652d6f66000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007e47657473207468652062616c616e6365206f6620616e20657263323020746f6b656e20666f7220616e206163636f756e742e2054686520666972737420696e7075742069732074686520746f6b656e206164647265737320616e6420746865207365636f6e6420697320746865206163636f756e7420616464726573732e000065726332302d746f74616c2d737570706c79000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000048476574732074686520746f74616c20737570706c79206f6620616e20657263323020746f6b656e2e2054686520696e7075742069732074686520746f6b656e20616464726573732e0000000000000000000000000000000000000000000000006572633732312d62616c616e63652d6f660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007f47657473207468652062616c616e6365206f6620616e2065726337323120746f6b656e20666f7220616e206163636f756e742e2054686520666972737420696e7075742069732074686520746f6b656e206164647265737320616e6420746865207365636f6e6420697320746865206163636f756e7420616464726573732e006572633732312d6f776e65722d6f660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000674765747320746865206f776e6572206f6620616e2065726337323120746f6b656e2e2054686520666972737420696e7075742069732074686520746f6b656e206164647265737320616e6420746865207365636f6e642069732074686520746f6b656e2069642e00000000000000000000000000000000000000000000000000657263353331332d6f776e657200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001064765747320746865206f776e6572206f6620616e206572633533313320636f6d70617469626c6520636f6e74726163742e204e6f746520746861742065726335333133207370656369666963616c6c7920444f4553204e4f5420646f20616e79206f6e636861696e20636f6d7061746962696c69747920636865636b732c20736f207468652065787072657373696f6e20617574686f7220697320726573706f6e7369626c6520666f7220656e737572696e672074686520636f6e747261637420697320636f6d70617469626c652e2054686520696e7075742069732074686520636f6e7472616374206164647265737320746f2067657420746865206f776e6572206f662e0000000000000000000000000000000000000000000000000000626c6f636b2d6e756d6265720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000195468652063757272656e7420626c6f636b206e756d6265722e00000000000000636861696e2d6964000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000155468652063757272656e7420636861696e2069642e00000000000000000000006d61782d696e742d76616c7565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000003b546865206d6178696d756d20706f737369626c65206e6f6e2d6e6567617469766520696e74656765722076616c75652e20325e323536202d20312e00000000006d61782d646563696d616c31382d76616c75650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000043546865206d6178696d756d20706f737369626c6520313820646563696d616c20666978656420706f696e742076616c75652e20726f7567686c7920312e31356537372e0000000000000000000000000000000000000000000000000000000000626c6f636b2d74696d657374616d7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001c5468652063757272656e7420626c6f636b2074696d657374616d702e00000000616e79000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000045546865206669727374206e6f6e2d7a65726f2076616c7565206f7574206f6620616c6c20696e707574732c206f72203020696620657665727920696e70757420697320302e000000000000000000000000000000000000000000000000000000636f6e646974696f6e73000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000014054726561747320696e7075747320617320706169727769736520636f6e646974696f6e2f76616c75652070616972732e20546865206669727374206e6f6e7a65726f20636f6e646974696f6e27732076616c756520697320757365642e204966206e6f20636f6e646974696f6e7320617265206e6f6e7a65726f2c207468652065787072657373696f6e20726576657274732e2050726f76696465206120636f6e7374616e74206e6f6e7a65726f2076616c756520746f20646566696e6520612066616c6c6261636b20636173652e20496620746865206e756d626572206f6620696e70757473206973206f64642c207468652066696e616c2076616c7565206973207573656420617320616e206572726f7220737472696e6720696e2074686520636173652074686174206e6f20636f6e646974696f6e73206d617463682e656e73757265000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000087526576657274732069662074686520666972737420696e70757420697320302e20546865207365636f6e6420696e707574206973206120737472696e6720746861742069732075736564206173207468652072657665727420726561736f6e2069662074686520666972737420696e70757420697320302e204861732030206f7574707574732e00000000000000000000000000000000000000000000000000657175616c2d746f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000273120696620616c6c20696e707574732061726520657175616c2c2030206f74686572776973652e00000000000000000000000000000000000000000000000000657665727900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041546865206c617374206e6f6e7a65726f2076616c7565206f7574206f6620616c6c20696e707574732c206f72203020696620616e7920696e70757420697320302e00000000000000000000000000000000000000000000000000000000000000677265617465722d7468616e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000043312069662074686520666972737420696e7075742069732067726561746572207468616e20746865207365636f6e6420696e7075742c2030206f74686572776973652e0000000000000000000000000000000000000000000000000000000000677265617465722d7468616e2d6f722d657175616c2d746f00000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004f312069662074686520666972737420696e7075742069732067726561746572207468616e206f7220657175616c20746f20746865207365636f6e6420696e7075742c2030206f74686572776973652e000000000000000000000000000000000069660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007549662074686520666972737420696e707574206973206e6f6e7a65726f2c20746865207365636f6e6420696e70757420697320757365642e204f74686572776973652c2074686520746869726420696e70757420697320757365642e2049662069732065616765726c79206576616c75617465642e000000000000000000000069732d7a65726f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000021312069662074686520696e70757420697320302c2030206f74686572776973652e000000000000000000000000000000000000000000000000000000000000006c6573732d7468616e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000040312069662074686520666972737420696e707574206973206c657373207468616e20746865207365636f6e6420696e7075742c2030206f74686572776973652e6c6573732d7468616e2d6f722d657175616c2d746f00000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004c312069662074686520666972737420696e707574206973206c657373207468616e206f7220657175616c20746f20746865207365636f6e6420696e7075742c2030206f74686572776973652e0000000000000000000000000000000000000000646563696d616c31382d6578706f6e656e7469616c2d67726f77746800000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e543616c63756c6174657320616e206578706f6e656e7469616c2067726f7774682063757276652061732060626173652831202b2072617465295e7460207768657265206062617365602069732074686520696e697469616c2076616c75652c20607261746560206973207468652072617465206f662067726f77746820616e642060746020697320756e697473206f662074696d652e20496e7075747320696e206f7264657220617265206062617365602c206072617465602c20616e642060746020726573706563746976656c7920617320646563696d616c2031382076616c7565732e000000000000000000000000000000000000000000000000000000646563696d616c31382d6c696e6561722d67726f777468000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000e043616c63756c617465732061206c696e6561722067726f777468206375727665206173206062617365202b202872617465202a20742960207768657265206062617365602069732074686520696e697469616c2076616c75652c20607261746560206973207468652072617465206f662067726f77746820616e642060746020697320756e697473206f662074696d652e20496e7075747320696e206f7264657220617265206062617365602c206072617465602c20616e642060746020726573706563746976656c7920617320646563696d616c2031382076616c7565732e646563696d616c31382d6176670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000039313820646563696d616c20666978656420706f696e742061726974686d657469632061766572616765206f662074776f206e756d626572732e00000000000000646563696d616c31382d6365696c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002b313820646563696d616c20666978656420706f696e74206365696c696e67206f662061206e756d6265722e000000000000000000000000000000000000000000646563696d616c31382d6469760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000082446976696465732074686520666972737420696e70757420627920616c6c206f7468657220696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620616e792064697669736f72206973207a65726f2e000000000000000000000000000000000000000000000000000000000000646563696d616c31382d65787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c343616c63756c6174657320746865206e61747572616c206578706f6e656e7469616c20655e7820776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e0000000000000000000000000000000000000000000000000000000000646563696d616c31382d65787032000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000c243616c63756c61746573207468652062696e617279206578706f6e656e7469616c20325e7820776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000000000000000000000000000000000000000646563696d616c31382d666c6f6f72000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000029313820646563696d616c20666978656420706f696e7420666c6f6f72206f662061206e756d6265722e0000000000000000000000000000000000000000000000646563696d616c31382d6672616300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000033313820646563696d616c20666978656420706f696e74206672616374696f6e616c2070617274206f662061206e756d6265722e00000000000000000000000000646563696d616c31382d676d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008043616c63756c61746573207468652067656f6d6574726963206d65616e206f6620616c6c20696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620616e7920696e707574206973207a65726f2e646563696d616c31382d68656164726f6f6d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a6313820646563696d616c20666978656420706f696e742068656164726f6f6d206f662061206e756d6265722e20492e652e207468652064697374616e636520746f20746865206e6578742077686f6c65206e756d626572202831653138202d2066726163287829292e205468652068656164726f6f6d20617420616e792077686f6c6520646563696d616c203138206e756d626572206973203165313820286e6f742030292e0000000000000000000000000000000000000000000000000000646563696d616c31382d696e76000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000007f43616c63756c617465732074686520696e76657273652031202f2078206f662074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e00646563696d616c31382d6c6e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009143616c63756c6174657320746865206e61747572616c206c6f6761726974686d206c6e28782920776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e000000000000000000000000000000646563696d616c31382d6c6f67313000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009443616c63756c61746573207468652062617365203130206c6f6761726974686d206c6f67313028782920776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e000000000000000000000000646563696d616c31382d6c6f67320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000009243616c63756c617465732074686520626173652032206c6f6761726974686d206c6f673228782920776865726520782069732074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973207a65726f2e0000000000000000000000000000646563696d616c31382d6d756c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a04d756c7469706c69657320616c6c20696e7075747320746f67657468657220617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206d756c7469706c69636174696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e646563696d616c31382d706f7765720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000cb5261697365732074686520666972737420696e707574206173206120666978656420706f696e7420313820646563696d616c2076616c756520746f2074686520706f776572206f6620746865207365636f6e6420696e707574206173206120666978656420706f696e7420313820646563696d616c2076616c75652e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000000000000000000000646563696d616c31382d706f7765722d696e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000685261697365732074686520666972737420696e707574206173206120666978656420706f696e7420313820646563696d616c2076616c756520746f2074686520706f776572206f6620746865207365636f6e6420696e70757420617320616e20696e74656765722e000000000000000000000000000000000000000000000000646563696d616c31382d7363616c652d31382d64796e616d6963000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001025363616c657320612076616c75652066726f6d20736f6d6520666978656420706f696e7420646563696d616c207363616c6520746f20313820646563696d616c20666978656420706f696e742e2054686520666972737420696e70757420697320746865207363616c6520746f207363616c652066726f6d20616e6420746865207365636f6e64206973207468652076616c756520746f207363616c652e205468652074776f206f7074696f6e616c206f706572616e647320636f6e74726f6c20726f756e64696e6720616e642073617475726174696f6e20726573706563746976656c79206173207065722060646563696d616c31382d7363616c652d3138602e000000000000000000000000000000000000000000000000000000000000646563696d616c31382d7363616c652d313800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000015d5363616c657320616e20696e7075742076616c75652066726f6d20736f6d6520666978656420706f696e7420646563696d616c207363616c6520746f20313820646563696d616c20666978656420706f696e742e20546865206669727374206f706572616e6420697320746865207363616c6520746f207363616c652066726f6d2e20546865207365636f6e6420286f7074696f6e616c29206f706572616e6420636f6e74726f6c7320726f756e64696e672077686572652030202864656661756c742920726f756e647320646f776e20616e64203120726f756e64732075702e2054686520746869726420286f7074696f6e616c29206f706572616e6420636f6e74726f6c732073617475726174696f6e2077686572652030202864656661756c7429206572726f7273206f6e206f766572666c6f7720616e64203120736174757261746573206174206d61782d646563696d616c2d76616c75652e000000696e742d746f2d646563696d616c313800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000ce5363616c657320616e20696e74656765722076616c756520746f20313820646563696d616c20666978656420706f696e742c20452e672e2031206265636f6d6573203165313820616e64203130206265636f6d657320316531392e204964656e746963616c20746f2060646563696d616c31382d7363616c652d313860207769746820616e20696e707574207363616c65206f6620302c206275742070657268617073206d6f7265206c656769626c652e20446f6573204e4f5420737570706f72742073617475726174696f6e2e000000000000000000000000000000000000646563696d616c31382d7363616c652d6e2d64796e616d696300000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001065363616c657320616e20696e7075742076616c75652066726f6d20313820646563696d616c20666978656420706f696e7420746f20736f6d65206f7468657220666978656420706f696e74207363616c65204e2e2054686520666972737420696e70757420697320746865207363616c6520746f207363616c6520746f20616e6420746865207365636f6e64206973207468652076616c756520746f207363616c652e205468652074776f206f7074696f6e616c206f706572616e6420636f6e74726f6c7320726f756e64696e6720616e642073617475726174696f6e20726573706563746976656c79206173207065722060646563696d616c31382d7363616c652d6e602e0000000000000000000000000000000000000000000000000000646563696d616c31382d7363616c652d6e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000015b5363616c657320616e20696e7075742076616c75652066726f6d20313820646563696d616c20666978656420706f696e7420746f20736f6d65206f7468657220666978656420706f696e74207363616c65204e2e20546865206669727374206f706572616e6420697320746865207363616c6520746f207363616c6520746f2e20546865207365636f6e6420286f7074696f6e616c29206f706572616e6420636f6e74726f6c7320726f756e64696e672077686572652030202864656661756c742920726f756e647320646f776e20616e64203120726f756e64732075702e2054686520746869726420286f7074696f6e616c29206f706572616e6420636f6e74726f6c732073617475726174696f6e2077686572652030202864656661756c7429206572726f7273206f6e206f766572666c6f7720616e64203120736174757261746573206174206d61782d646563696d616c2d76616c75652e0000000000646563696d616c31382d746f2d696e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000f75363616c6573206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e652720697320316531382920746f2061206e6f6e2d6e6567617469766520696e74656765722e20416c7761797320666c6f6f72732f726f756e647320646f776e20616e79206672616374696f6e616c207061727420746f20746865206e6561726573742077686f6c6520696e74656765722e204964656e746963616c20746f2060646563696d616c31382d7363616c652d6e60207769746820616e20696e707574207363616c65206f6620302c206275742070657268617073206d6f7265206c656769626c652e000000000000000000646563696d616c31382d736e61702d746f2d756e69740000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000114526f756e6473206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e652720697320316531382920746f20746865206e6561726573742077686f6c65206e756d6265722069662069742069732077697468696e20746865207468726573686f6c642064697374616e63652066726f6d20746861742077686f6c65206e756d6265722e2054686520666972737420696e70757420697320746865207468726573686f6c6420617320616e20313820646563696d616c20666978656420706f696e74206e756d62657220616e6420746865207365636f6e64206973207468652076616c756520746f20736e617020746f20746865206e65617265737420756e69742e000000000000000000000000646563696d616c31382d737172740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008143616c63756c61746573207468652073717561726520726f6f74206f662074686520696e707574206173206120666978656420706f696e7420313820646563696d616c206e756d6265722028692e652e20276f6e65272069732031653138292e204572726f72732069662074686520696e707574206973206e656761746976652e00000000000000000000000000000000000000000000000000000000000000696e742d61646400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000764164647320616c6c20696e7075747320746f676574686572206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620746865206164646974696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e00000000000000000000646563696d616c31382d61646400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000944164647320616c6c20696e7075747320746f67657468657220617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e204572726f727320696620746865206164646974696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000696e742d6469760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000064446976696465732074686520666972737420696e70757420627920616c6c206f7468657220696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620616e792064697669736f72206973207a65726f2e00000000000000000000000000000000000000000000000000000000696e742d65787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a05261697365732074686520666972737420696e70757420746f2074686520706f776572206f6620616c6c206f7468657220696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620746865206578706f6e656e74696174696f6e20776f756c642065786365656420746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e696e742d6d6178000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004146696e647320746865206d6178696d756d2076616c75652066726f6d20616c6c20696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e00000000000000000000000000000000000000000000000000000000000000646563696d616c31382d6d6178000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005f46696e647320746865206d6178696d756d2076616c75652066726f6d20616c6c20696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e00696e742d6d696e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004146696e647320746865206d696e696d756d2076616c75652066726f6d20616c6c20696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e00000000000000000000000000000000000000000000000000000000000000646563696d616c31382d6d696e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005f46696e647320746865206d696e696d756d2076616c75652066726f6d20616c6c20696e7075747320617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e00696e742d6d6f6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000644d6f64756c6f732074686520666972737420696e70757420627920616c6c206f7468657220696e70757473206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620616e792064697669736f72206973207a65726f2e00000000000000000000000000000000000000000000000000000000696e742d6d756c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000824d756c7469706c69657320616c6c20696e7075747320746f676574686572206173206e6f6e2d6e6567617469766520696e7465676572732e204572726f727320696620746865206d756c7469706c69636174696f6e206578636565647320746865206d6178696d756d2076616c75652028726f7567686c7920312e3135653737292e000000000000000000000000000000000000000000000000000000000000696e742d737562000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000015b53756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e707574206173206e6f6e2d6e6567617469766520696e7465676572732e20546865206f7074696f6e616c206f706572616e6420636f6e74726f6c732077686574686572207375627472616374696f6e2077696c6c20736174757261746520617420302e205468652064656661756c74206265686176696f75722c20616e6420776861742077696c6c2068617070656e20696620746865206f706572616e6420697320302c20697320746861742074686520776f72642077696c6c2072657665727420696620746865207375627472616374696f6e20776f756c6420726573756c7420696e2061206e656761746976652076616c75652e20496620746865206f706572616e6420697320312c2074686520776f72642077696c6c20736174757261746520617420302028652e672e20312d323d30292e0000000000696e742d73617475726174696e672d73756200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000006053756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e707574206173206e6f6e2d6e6567617469766520696e7465676572732e2053617475726174657320617420302028652e672e20312d323d30292e646563696d616c31382d737562000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000017f53756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e70757420617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e20546865206f7074696f6e616c206f706572616e6420636f6e74726f6c732077686574686572207375627472616374696f6e2077696c6c20736174757261746520617420302e205468652064656661756c74206265686176696f75722c20616e6420776861742077696c6c2068617070656e20696620746865206f706572616e6420697320302c20697320746861742074686520776f72642077696c6c2072657665727420696620746865207375627472616374696f6e20776f756c6420726573756c7420696e2061206e656761746976652076616c75652e20496620746865206f706572616e6420697320312c2074686520776f72642077696c6c20736174757261746520617420302028652e672e20316531382d326531383d30292e00646563696d616c31382d73617475726174696e672d73756200000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008453756274726163747320616c6c20696e707574732066726f6d2074686520666972737420696e70757420617320666978656420706f696e7420313820646563696d616c206e756d626572732028692e652e20276f6e65272069732031653138292e2053617475726174657320617420302028652e672e20316531382d326531383d30292e000000000000000000000000000000000000000000000000000000006765740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000424765747320612076616c75652066726f6d2073746f726167652e20546865206669727374206f706572616e6420697320746865206b657920746f206c6f6f6b75702e0000000000000000000000000000000000000000000000000000000000007365740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000685365747320612076616c756520696e2073746f726167652e20546865206669727374206f706572616e6420697320746865206b657920746f2073657420616e6420746865207365636f6e64206f706572616e64206973207468652076616c756520746f207365742e000000000000000000000000000000000000000000000000".into()).unwrap();
        let item = RainMetaDocumentV1Item {
            magic,
            payload: ByteBuf::from(payload),
            content_encoding: ContentEncoding::None,
            content_language: ContentLanguage::None,
            content_type: ContentType::None,
        };

        let result = AuthoringMetaV2::try_from(item);

        assert!(result.is_err());
    }
}
